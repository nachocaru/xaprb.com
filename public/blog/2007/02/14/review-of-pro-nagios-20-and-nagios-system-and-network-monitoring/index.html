<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title> Review of Pro Nagios 2.0 and Nagios System and Network Monitoring &middot; Xaprb </title>

  
  <link rel="stylesheet" href="http://www.xaprb.com/css/poole.css">
  <link rel="stylesheet" href="http://www.xaprb.com/css/syntax.css">
  <link rel="stylesheet" href="http://www.xaprb.com/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.ico">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Xaprb" />
</head>

<body>

<div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>Xaprb</h1>
      <p class="lead">
		Stay Curious!
      </p>
    </div>

    <ul class="sidebar-nav">
      <li><a href="/">Home</a> </li>
      
        <li><a href="http://www.xaprb.com/about/"> About </a></li>
      
        <li><a href="http://www.xaprb.com/essential-books/"> Essential Books </a></li>
      
        <li><a href="http://www.xaprb.com/rx-toolkit/"> Regex Toolkit </a></li>
      
    </ul>

	 <p>
	 &copy; Baron Schwartz.
	 Contact: moc.brpax@norab, <a href="https://twitter.com/xaprb">Twitter</a>, <a href="https://linkedin.com/in/xaprb">LinkedIn</a>.
	 <br>Powered by <a href="http://hugo.spf13.com">Hugo</a>. <a href="/index.xml">RSS Feed</a></p>
						            
  </div>
</div>


    <div class="content container">
<div class="post">
  <h1>Review of Pro Nagios 2.0 and Nagios System and Network Monitoring</h1>
  <span class="post-date">Wed, Feb 14, 2007 in
		
		<a href="/categories/Reviews" class="btn btn-primary">Reviews</a>
		
  </span>
      

<p>Last week I read two books on Nagios. I found one easy to use and the other difficult.</p>

<h3 id="toc_0">The books</h3>

<p><a href="http://www.amazon.com/gp/product/1593270704?ie=UTF8&amp;#038;tag=xaprb-20&amp;#038;linkCode=as2&amp;#038;camp=1789&amp;#038;creative=9325&amp;#038;creativeASIN=1593270704"><img src="/media/2007/02/nagios_cov.jpg" width="125" height="165" alt="Cover of Nagios System and Network Monitoring"></a></p>

<p><a href="http://www.amazon.com/gp/product/1593270704?ie=UTF8&amp;#038;tag=xaprb-20&amp;#038;linkCode=as2&amp;#038;camp=1789&amp;#038;creative=9325&amp;#038;creativeASIN=1593270704">Nagios System and Network Monitoring (Wolfgang Barth, No Starch Press, 2006)</a> is a delight. It explained Nagios briefly and clearly, showed me how to get it running, and continues to be a useful reference. I rate it 4 out of 5 stars.</p>

<p><a href="http://www.amazon.com/gp/product/1590596099?ie=UTF8&#038;tag=xaprb-20&#038;link_code=as3&#038;camp=211189&#038;creative=373489&#038;creativeASIN=1590596099"><img src="/media/2007/02/pro-nagios.gif" alt="Cover of Pro Nagios 2.0" width="125" height="168" /></a></p>

<p><a href="http://www.amazon.com/gp/product/1590596099?ie=UTF8&#038;tag=xaprb-20&#038;link_code=as3&#038;camp=211189&#038;creative=373489&#038;creativeASIN=1590596099">Pro Nagios 2.0 (James Turnbull, Apress, 2006)</a> is hard for me to read, understand and use. Mr. Turnbull is clearly an expert on Nagios, but the book doesn&rsquo;t communicate his knowledge effectively. I give it two stars.</p>

<p>Despite the differences, the books are identical in many ways. Both have chapters on the same topics. They cover exactly the same subject matter in the same level of detail, have the same target audiences, were written about the same time, are about the same size, and so on. The differences are in organization and writing style.</p>

<p>Mr. Barth&rsquo;s book lets me do a breadth-first search of the subject matter, and Mr. Turnbull&rsquo;s makes me do a depth-first search. Breadth-first is a better way to learn a topic like Nagios.</p>

<h3 id="toc_1">Pro Nagios 2.0 (James Turnbull)</h3>

<p>I read James Turnbull&rsquo;s Pro Nagios 2.0 first. I brought it home for the weekend, and read past page 200 &ndash; more than half the book &ndash; but I did not learn much about Nagios. Here&rsquo;s why I found it hard to use:</p>

<ul>
<li><p>It explains difficult concepts abstractly. Here are some of the first sentences from Chapter 2&#8242;s introductory paragraph:</p>

<blockquote>
<p>You do this by defining a series of objects that represent the characteristics of the environment being monitored. You begin by defining your assets to the Nagios server. Nagios calls them <em>hosts</em>. Then you define the attributes and functions of these assets&hellip;</p>
</blockquote>

<p>The book would have been clearer if it used the concrete Nagios metaphors (hosts, services, contacts), but it describes many things in object-oriented programming terms.</p></li>

<li><p>It&rsquo;s hard to skim because it&rsquo;s organized depth-first. It usually begins a topic with a few sentences, then interrupts with a tip, note or caution. Then the text resumes with specific details, and demonstrates them with code, usually a configuration sample or a shell script.</p>

<p>There are few unbroken paragraphs of prose. This makes it hard to scan for headings, because they don&rsquo;t stand out visually.</p></li>

<li><p>It puts unimportant material before important topics, but you don&rsquo;t know that in advance. Here&rsquo;s an example: if a service is okay, Nagios assumes the service&rsquo;s host is too, so it&rsquo;s generally unnecessary to monitor hosts. Turnbull writes about how to monitor the hosts in detail <em>before</em> saying it&rsquo;s not important &ndash; for instance, beginning on page 39; then on page 42 he writes, &ldquo;Remember: don&rsquo;t schedule regular checks of your hosts!&rdquo; Again in the beginning of Chapter 5, &ldquo;Monitoring Hosts and Services,&rdquo; the section on hosts is before the section on services.</p></li>

<li><p>Its confusing sentences and passive voice make it hard to understand. For instance,</p>

<blockquote>
<p>These directives can either be unique to the type of object being defined &ndash; for example, a host object has a directive that defines its address, or generic and applicable to a number of object definitions.</p>
</blockquote>

<p>This confuses me because I can&rsquo;t immediately find the &ldquo;or&rdquo; that should correspond to the &ldquo;either,&rdquo; and when I do it seems to go with the &ldquo;for example,&rdquo; where it makes no sense.</p></li>

<li><p>It&rsquo;s too verbose, often using a paragraph when a few words would be clearer. Here is an example from page 37:</p>

<blockquote>
<p>Table 2-2 contains four columns. The first two columns indicate the directive name and description. The third and fourth columns indicate if the directive&rsquo;s value can be used as a macro and whether it is mandatory to the object definition. An object definition must have all the required mandatory directives included in the definition to be valid. An invalid object definition will result in Nagios failing to start. I&rsquo;ll discuss macros in a bit and in the &ldquo;Defining Commands&rdquo; section later in this chapter.</p>
</blockquote>

<p>I can count the columns myself, so I don&rsquo;t need the first sentence, and the columns have headings, so I don&rsquo;t need the next two either. The fourth is redundant both to the column headings and to itself. The fifth is in the passive voice, and the sixth is a forward reference. The paragraph&rsquo;s essence is &ldquo;Nagios will not start if you omit a mandatory directive,&rdquo; which states the obvious. I&rsquo;d delete the whole paragraph.</p></li>

<li><p>It&rsquo;s self-contradictory. For example, on page 44 the book shows how to enable &ldquo;freshness&rdquo; checks:</p>

<blockquote>
<p>In order to enable freshness checking, there are some other directives in the main nagios.cfg file that also need to be set. These control freshness checks for hosts. I&rsquo;ve listed these directives in Example 2-8.</p>

<p><strong>Example 2-8.</strong> The nagios.cfg Freshness Items</p>

<p><code>check_host_freshness=0&lt;br /&gt;
host_freshness_check_interval=60</code></p>
</blockquote>

<p>This talks about <em>enabling</em> freshness checks and then shows the configuration setting that <em>disables</em> them. It makes me backtrack to be sure I read it right. This happens fairly often.</p></li>

<li><p>It interrupts with frequent references, which rarely have page or chapter numbers with them and usually introduce repeated material. Since they don&rsquo;t have page numbers, you can&rsquo;t find where they refer to; in one case I couldn&rsquo;t find a reference even after looking for quite a while and consulting the index. Again, it&rsquo;s hard to locate sections by scanning for headings, so the lack of page numbers makes the references nearly useless. Forward references are especially distracting.</p></li>

<li><p>It over-uses Note, Tip, and Caution sections. Chapter 2 has at least 47 of them in 52 pages, and there are seven in pages 220-223. They are highlighted with whitespace and two horizontal rules that span the page from edge to edge, so they&rsquo;re very intrusive. Some examples: on page 59, while explaining equations that control a scheduling algorithm, a note says &ldquo;<code>ceil</code> indicates that you need to round up the result to the nearest integer.&rdquo; And on page 221, while discussing third-party tools, a note says &ldquo;The NAN client and daemon are written in Perl,&rdquo; which is irrelevant. Some of these would have been okay as footnotes, but many should have been omitted.</p></li>
</ul>

<p>After a while I tried to skim through and read the book at a higher level, but I found it very difficult.</p>

<p>It&rsquo;s not impossible to use, and I don&rsquo;t mean to criticize too much. For example, once I was familiar with Nagios I found it useful for reference a few times. If you know what you want to find, it&rsquo;s easy to navigate the book with the table of contents or the index (though the index doesn&rsquo;t seem to be complete). I remembered seeing something about how to organize configuration files in various ways, and I referred back to that since Mr. Barth&rsquo;s book didn&rsquo;t mention it. This discussion, on pages 32-35, helped me think about how to arrange configuration files into subdirectories with the <code>cfg_dir</code> directive.</p>

<p>On the whole, I found the book a poor introduction to Nagios.</p>

<h3 id="toc_2">Nagios System and Network Monitoring (Wolfgang Barth)</h3>

<p>Mr. Barth&rsquo;s book succeeds through clarity, organization, detail, and ease of use. His first language is apparently German, so his English is not always elegant, but it is concise and communicates his knowledge of Nagios well.</p>

<p>The best thing about the book is the organization. The first part, &ldquo;From Source Code to a Running Installation,&rdquo; is three compact chapters on everything you need to get Nagios working. The first chapter is about compiling, installing, and basic web interface configuration. The second is an overview of general Nagios configuration &ndash; the stuff you need to actually monitor things. The third is about checking your configuration and starting Nagios.</p>

<p>By page 55 I understood more about Nagios than I was able to glean from Pro Nagios 2.0. When I finished the first three chapters, I had Nagios running and monitoring itself.</p>

<p>The second part is called &ldquo;In More Detail,&rdquo; and it was very helpful while I configured Nagios to monitor other servers. It was a useful reference when I looked up specific topics, and easy to skim for important instructions and pitfalls. The good introductory sentences make it easy to decide whether I need to read a section, and the uninterrupted text makes it easy to skip if I don&rsquo;t. Large blocks of text make headings stand out, so there&rsquo;s less need to use the table of contents. References have page numbers.</p>

<p>There are few footnotes, and no interruptions in the text. When there are configuration examples, the book shows the whole configuration definition for context, but makes the relevant parts bold, so they&rsquo;re easy to see. There are lots of diagrams, which clearly show concepts that would require hundreds of words to explain. Captions are in the margins so they don&rsquo;t interrupt the text.</p>

<p>I could go on, but suffice to say it&rsquo;s a delight to read and use this book.</p>

<p>On the downside, I dislike the typeface the Barth book uses. Though I&rsquo;m no expert on typefaces, I think it has a hard-on-the-eyes combination of shapes, heavy line-weights in odd places, and internal white-space. The typeface is sans-serif, so the letters are harder to recognize; for example, the &ldquo;c&rdquo; looks a lot like the &ldquo;e.&rdquo; It is difficult to speed-read. On the other hand, the text is fully justified and hyphenated (the publisher told me he believes it was typeset with LaTeX, which explains a lot &ndash; I love LaTeX). This makes it easier to read than Apress&rsquo;s standard ragged-right typesetting.</p>

<h3 id="toc_3">The difference between the books</h3>

<p>Let me show you the differences between the two books by comparing how they explain &ldquo;flapping,&rdquo; a Nagios feature to prevent a flood of notifications from services that are cycling between states.</p>

<p>The earliest index entry for flapping in the Turnbull book is on page 47. On pages 47 and 48, Turnbull explains the algorithm in detail:</p>

<blockquote>
<p>So how does Nagios determine if a host or service is flapping? When you enable flap detection, Nagios keeps a record of the last 21 states of the host or service in an array. It then counts the number of times the states in the array have changed. This is calculated as a percentage. For example, with 21 states recorded we have a possible 20 state changes. For a normal-behaving host or service, it may be that the last recorded 21 states were OK. Hence, the percentage of states change is 0 percent. If, however, during the last 21 recorded states the host or service changed state 9 times, then the percentage of state change is 45 percent. But there is another added layer of complexity in this calculation. The states in this array are weighted &ndash; the newest state is considered 50 percent more important than the oldest state. This is because Nagios considers that the newer states are more indicative of the current behavior of the host or service than the older states.</p>
</blockquote>

<p>Compare those 175 words to page 219 in the Barth book:</p>

<blockquote>
<p>If a regular test shows that service or computer is changing its data continuously, this is called <em>flapping</em> in Nagios.</p>
</blockquote>

<p>The Barth book says no more on the topic, but refers interested readers to the appendix on page 401, where it explains flapping with a nice diagram.</p>

<p>This illustrates the major differences between the books:</p>

<ol>
<li>The Barth book tells you where to learn more, if you want to know. The Turnbull book practically forces you to read through irrelevant details.</li>
<li>The Barth book presents minor concepts like flapping later in the book (page 219 and 401). The Turnbull book puts the trivia in the beginning (page 47).</li>
<li>The Barth book uses a dozen or so words, or a diagram. The Turnbull book uses hundreds of words instead.</li>
</ol>

<h3 id="toc_4">Summary</h3>

<p>I like Wolfgang Barth&rsquo;s <a href="http://www.amazon.com/gp/product/1593270704?ie=UTF8&amp;#038;tag=xaprb-20&amp;#038;linkCode=as2&amp;#038;camp=1789&amp;#038;creative=9325&amp;#038;creativeASIN=1593270704">Nagios System and Network Monitoring</a> better than James Turnbull&rsquo;s <a href="http://www.amazon.com/gp/product/1590596099?ie=UTF8&amp;#038;tag=xaprb-20&amp;#038;link_code=as3&amp;#038;camp=211189&amp;#038;creative=373489&amp;#038;creativeASIN=1590596099">Pro Nagios 2.0</a>.</p>

		                        <hr>
                        <h2>Comments</h2>
                        <div id="disqus_thread"></div>
                        <script type="text/javascript">
                            var disqus_shortname = 'xaprb';
                            (function() {
                                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                            })();
                        </script>

</div>
</div>

  </body>
</html>
